# quailty control of illumina reads with fastp (v 0.23.4)
## (Use D1 as an example)
fastp -c -i D1_1.fq.gz -I D1_2.fq.gz -o D1_1.clean.fq.gz -O D1_2.clean.fq.gz

# salmon (v.1.10.1) mapping and quantification
salmon index -t Cni.v2.transcript.fasta -i transcripts --keepDuplicates
salmon quant -i transcripts -l A -p 5 -1 D1_1.clean.fq.gz -2 D1_2.clean.fq.gz -o D1

# TMM normalization
mkdir quant
ls */quant.sf > quant/quant_files.fofn
perl abundance_estimates_to_matrix.pl --est_method salmon --quant_files quant/quant_files.fofn --name_sample_by_basedir --gene_trans_map quant/gene_trans_map --out_prefix quant/salmon

# Differential expression analysis
run_DE_analysis.pl --matrix quant/salmon.gene.counts.matrix --method edgeR --samples_file sample.info --contrasts contrasts.txt
