# assemble HiFi reads with Hifiasm 0.19.4-r575
hifiasm -o Cni.v2 -t 40 --hom-cov 67 --h1 HiC_R1_clean.rd.fq.gz --h2 HiC_R2_clean.rd.fq.gz Cni_genome_HiFi.fasta.gz
awk '/^S/{print ">"$2;print $3}' Cni.v2.hic.p_ctg.gfa > Cni.v2.hic.chr.fasta

# process the Hi-C valid reads by Juicer pipeline (v1.6)
bwa index Cni.v2.hic.p_ctg.fa
python generate_site_positions.py MboI genome Cni.v2.hic.p_ctg.fa
awk 'BEGIN{OFS="\t"}{print $1, $NF}' genome_MboI.txt > genome.chrom.sizes
juicer.sh -g Cni.v2.hic.p_ctg.fa -s MboI -z Cni.v2.hic.p_ctg.fa -y genome_MboI.txt -p genome.chrom.sizes -t 30

# scaffold with 3D de novo assembly (3D-DNA) pipeline (v180419)
run-asm-pipeline.sh --build-gapped-map --editor-repeat-coverage 5 --editor-coarse-resolution 50000 --editor-coarse-region 250000  Cni.v2.hic.p_ctg.fa merged_nodups.txt
run-asm-pipeline-post-review.sh -r Oed.hifiasm.FINAL.review.assembly --sort-output --build-gapped-map Cni.v2.hic.p_ctg.fa merged_nodups.txt
mv Cni.v2.hic.p_ctg.FINAL.fasta Cni.v2.hic.chr.fasta
